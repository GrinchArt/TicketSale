@model SearchResultViewModel
@{
    ViewData["Title"] = "Search Results";
}


@foreach (var routeSchedule in Model.RouteSchedules)
{
   
}


@if (Model.PageCount > 1)
{
    <nav aria-label="Page navigation example">
        <ul class="pagination">
            @for (int i = 1; i <= Model.PageCount; i++)
            {
                <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                    <a class="page-link" href="javascript:void(0);" onclick="loadPage(@i)">
                        @i
                    </a>
                </li>
            }
        </ul>
    </nav>
}


<div class="container">
    <h2>Search Results</h2>

    <!-- Filters -->
    <div id="filters">
        <h4>Search Filters</h4>
        <!--------- -->
    </div>

    <!-- Search Results -->
    <div id="search-results">
        @foreach (var result in Model.RouteSchedules)
        {
            if (result.Schedules.Any())
            {
                var schedule = result.Schedules.First();
            
            <div class="result-item">
                <div><strong>From:</strong> @result.RouteInfo.PlaceOfDeparture</div>
                <div><strong>To:</strong> @result.RouteInfo.PlaceOfDestination</div>
                    <div><strong>Departure Time:</strong> @schedule.DepartureTime.ToString("dd MMM yyyy HH:mm")</div>
                    <div><strong>Arrival Time:</strong> @schedule.ArrivalTime.ToString("dd MMM yyyy HH:mm")</div>
            </div>
            }
        }
    </div>

    <!-- Pagination -->
    <div id="pagination">
        <ul class="pagination">
            @for (var i = 1; i <= Model.PageCount; i++)
            {
                <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                    <a class="page-link" href="javascript:void(0);" onclick="loadPage(@i)">@i</a>
                </li>
            }
        </ul>
    </div>
</div>






<script>
    function loadPage(pageNumber) {

        var searchParams = {
            from: "@Model.Criteria.From",
            to: "@Model.Criteria.To",
            departureDate: "@Model.Criteria.DepartureDate?.ToString("yyyy-MM-dd")",
            returnDate: "@Model.Criteria.ReturnDate?.ToString("yyyy-MM-dd")",
            page: pageNumber
        };

        $.ajax({
            url: '@Url.Action("Search", "Home")',
            data: searchParams,
            type: 'GET',
            success: function (data) {
    
                $('#search-results-container').html(data);
            }
        });
    }
</script>